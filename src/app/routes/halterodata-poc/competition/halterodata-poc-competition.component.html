<div class="mb-8">
  <!-- Header Compétition Card -->
  <div
    class="relative overflow-hidden rounded-2xl border border-[#212e56]/50 bg-gradient-to-br from-[#0c1c3c]/90 to-[#050811]/90 shadow-2xl backdrop-blur-xl"
  >
    <!-- Gradient overlay -->
    <div
      class="absolute inset-0 bg-gradient-to-t from-[#050811] via-transparent to-transparent"
    ></div>

    <!-- Contenu -->
    <div class="relative p-6">
      <!-- En-tête principal -->
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-white sm:text-3xl">
          {{ competition?.name || "Compétition" }}
        </h2>
        <div
          class="mt-3 flex flex-wrap items-center gap-3 text-sm text-[#a8b2d2]"
        >
          <span class="flex items-center gap-1">
            <svg
              class="h-4 w-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8 7V3m8 4V3m-9 8h18M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
              />
            </svg>
            {{ competition?.date | date: "shortDate" }}
          </span>
          <span class="flex items-center gap-1">
            <svg
              class="h-4 w-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
              />
            </svg>
            {{ competition?.league }}
          </span>
        </div>
      </div>

      <!-- Pillules d'état -->
      <div class="mb-6 flex flex-wrap items-center gap-2">
        <div
          [ngClass]="{
            'border-[#4a9eff]/50 bg-[#4a9eff]/20 text-[#4a9eff]':
              competition?.state === 0,
            'border-[#22c55e]/50 bg-[#22c55e]/20 text-[#22c55e]':
              competition?.state === 1,
          }"
          class="rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide"
        >
          {{ competition?.state === 0 ? "En cours" : "Terminé" }}
        </div>
        <div
          [ngClass]="{
            'border-[#8b5cf6]/50 bg-[#8b5cf6]/20 text-[#8b5cf6]':
              competition?.gender === 0,
            'border-[#ec4899]/50 bg-[#ec4899]/20 text-[#ec4899]':
              competition?.gender === 1,
            'border-[#06b6d4]/50 bg-[#06b6d4]/20 text-[#06b6d4]':
              competition?.gender === 2,
          }"
          class="rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide"
        >
          {{
            competition?.gender === 0
              ? "Masculin"
              : competition?.gender === 1
                ? "Féminin"
                : "Mixte"
          }}
        </div>
        <div
          [ngClass]="{
            'border-[#f97316]/50 bg-[#f97316]/20 text-[#f97316]':
              !competition?.type,
            'border-[#14b8a6]/50 bg-[#14b8a6]/20 text-[#14b8a6]':
              competition?.type,
          }"
          class="rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide"
        >
          {{ competition?.type ? "En équipe" : "Individuelle" }}
        </div>
      </div>
    </div>
  </div>
</div>

<div class="space-y-8">
  <div *ngIf="loading" class="text-center text-sm text-[#a8b2d2]">
    Chargement des inscriptions...
  </div>

  <div
    class="overflow-hidden rounded-2xl border border-[#212e56]/50 bg-[#050811]/40"
  >
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-[#2b3658]">
        <thead class="bg-[#0b172b]/60">
          <tr class="text-xs text-[#a8b2d2] sm:text-sm">
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">
              Licence
            </th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">Nom</th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Année
            </th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Club
            </th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Nation
            </th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              P.C
            </th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">S1</th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">S2</th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">S3</th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Arraché
            </th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">C1</th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">C2</th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">C3</th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Epaulé jeté
            </th>
            <th class="whitespace-nowrap px-2 py-2 text-left sm:px-3">Total</th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Série
            </th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              Catégorie
            </th>
            <th
              class="mobile-hide whitespace-nowrap px-2 py-2 text-left sm:px-3"
            >
              IWF
            </th>
          </tr>
        </thead>
        <tbody
          class="divide-y divide-[#24304f] bg-[#07122a]/40 text-white"
          *ngIf="competition != null && competition.details != null"
        >
          <tr
            *ngFor="let entry of competition.details || []; trackBy: trackById"
            class="text-sm hover:bg-[#07122a]/30"
          >
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ entry.athlete?.licenceId || "—" }}
            </td>
            <td class="px-2 py-2 sm:px-3 sm:py-3">
              <a
                [routerLink]="['/halterodatapoc/athlete', entry.athlete?.id]"
                class="text-[#4a9eff] hover:underline"
              >
                {{ entry.athlete?.fullName || "—" }}
              </a>
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ getYear(entry) || "—" }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ entry.club || "—" }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ entry.countryCode || "—" }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{
                entry.bodyWeight !== null && entry.bodyWeight !== undefined
                  ? entry.bodyWeight
                  : "—"
              }}
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.snatch1 !== null && entry.snatch1 !== undefined;
                  else snatch1Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.snatch1 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.snatch1 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.snatch1 }}
              </span>
              <ng-template #snatch1Empty>—</ng-template>
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.snatch2 !== null && entry.snatch2 !== undefined;
                  else snatch2Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.snatch2 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.snatch2 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.snatch2 }}
              </span>
              <ng-template #snatch2Empty>—</ng-template>
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.snatch3 !== null && entry.snatch3 !== undefined;
                  else snatch3Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.snatch3 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.snatch3 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.snatch3 }}
              </span>
              <ng-template #snatch3Empty>—</ng-template>
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{
                entry.bestSnatch !== null && entry.bestSnatch !== undefined
                  ? entry.bestSnatch
                  : "—"
              }}
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.cj1 !== null && entry.cj1 !== undefined;
                  else cj1Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.cj1 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.cj1 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.cj1 }}
              </span>
              <ng-template #cj1Empty>—</ng-template>
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.cj2 !== null && entry.cj2 !== undefined;
                  else cj2Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.cj2 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.cj2 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.cj2 }}
              </span>
              <ng-template #cj2Empty>—</ng-template>
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              <span
                *ngIf="
                  entry.cj3 !== null && entry.cj3 !== undefined;
                  else cj3Empty
                "
                class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-semibold"
                [ngClass]="
                  entry.cj3 > 0
                    ? 'border-[#22c55e]/40 bg-[#22c55e]/20 text-[#22c55e]'
                    : entry.cj3 < 0
                      ? 'border-[#ef4444]/40 bg-[#ef4444]/20 text-[#ef4444]'
                      : 'border-[#64748b]/40 bg-[#64748b]/10 text-[#a8b2d2]'
                "
              >
                {{ entry.cj3 }}
              </span>
              <ng-template #cj3Empty>—</ng-template>
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{
                entry.bestCj !== null && entry.bestCj !== undefined
                  ? entry.bestCj
                  : "—"
              }}
            </td>
            <td class="whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{
                entry.total !== null && entry.total !== undefined
                  ? entry.total
                  : "—"
              }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ entry.serie || "—" }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{ entry.category || "—" }}
            </td>
            <td class="mobile-hide whitespace-nowrap px-2 py-2 sm:px-3 sm:py-3">
              {{
                entry.iwf !== null && entry.iwf !== undefined ? entry.iwf : "—"
              }}
            </td>
          </tr>
          <tr
            *ngIf="(competition.details || []).length === 0"
            class="text-sm text-[#a8b2d2]"
          >
            <td class="p-4" colspan="18">Aucune inscription trouvée.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div
      class="flex items-center justify-between border-t border-[#212e56]/30 p-4 text-sm text-[#a8b2d2]"
    >
      <div>
        Affichage {{ (currentPage - 1) * pageSize + 1 }} -
        {{ Math.min(currentPage * pageSize, totalItems) }} sur
        {{ totalItems || 0 }}
      </div>
      <div class="flex items-center gap-2">
        <button
          (click)="changePage(currentPage - 1)"
          [disabled]="currentPage <= 1"
          class="rounded bg-[#050811]/60 px-3 py-1"
        >
          Préc
        </button>
        <div class="w-10 text-center">{{ currentPage || 1 }}</div>
        <button
          (click)="changePage(currentPage + 1)"
          [disabled]="currentPage >= totalPages"
          class="rounded bg-[#050811]/60 px-3 py-1"
        >
          Suiv
        </button>
      </div>
    </div>
  </div>
</div>
